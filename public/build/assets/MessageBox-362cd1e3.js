import{r as n,j as e}from"./app-23e59b41.js";import{k as A,l as E}from"./index-aef4e9b2.js";import{A as F}from"./AuthenticatedLayout-b15faaed.js";import{I as L}from"./index.es-0c073cd6.js";import{l as d}from"./lodash-b0739673.js";import{k as P,Q as D}from"./react-toastify.esm-2ff0bd8a.js";import{F as B}from"./fuse.esm-88e2763d.js";import"./ApplicationLogo-2e86c49f.js";import"./transition-a14f84a6.js";const g=({message:a,onSelect:r,selected:i})=>{const[c,m]=n.useState(!1);return e.jsxs("div",{className:"flex border border-base-300 rounded-md bg-gray-900 mb-5",children:[e.jsxs("div",{className:"flex items-center px-2 custom-checkbox",children:[e.jsx("input",{id:`${a.id}`,type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",onChange:()=>r(a.id),checked:i}),e.jsx("label",{htmlFor:`${a.id}`,className:"sr-only",children:"checkbox"})]}),e.jsxs("div",{className:"collapse collapse-arrow",children:[e.jsx("input",{type:"radio",name:"my-accordion-4",checked:c}),e.jsxs("div",{className:"collapse-title text-xl font-medium flex justify-between",onClick:()=>m(!c),children:[e.jsxs("div",{className:"flex-row",children:[e.jsx("h2",{className:"text-md font-semibold text-gray-300",children:a.subject}),e.jsx("p",{className:"text-sm font-serif pt-1 text-gray-400",children:a.sender_name})]}),e.jsx("div",{className:"my-auto text-sm font-mono",children:a.email})]}),e.jsx("div",{className:"collapse-content",children:e.jsx("p",{className:"text-md py-3",children:a.body})})]})]})},R=()=>e.jsxs("div",{className:"flex items-center mx-10 justify-between pt-10 bg-gray-900 rounded",children:[e.jsxs("div",{className:"my-auto px-4 pb-5",children:[e.jsx("div",{className:"h-3 bg-gray-300 rounded-full dark:bg-gray-600 w-24 mb-2.5"}),e.jsx("div",{className:"w-32 h-2 bg-gray-200 rounded-full dark:bg-gray-700"})]}),e.jsx("div",{className:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-40 mb-10"})]}),z=({auth:a})=>{const{data:r,fetchNextPage:i,hasNextPage:c,isFetchingNextPage:m,isLoading:h,isFetching:b}=A(),{mutateAsync:p}=E(),[o,l]=n.useState([]),[u,f]=n.useState(),[y,j]=n.useState([]);n.useEffect(()=>{if(!d.isEmpty(r)){const s=r.pages.flatMap(t=>t.data);j(s)}},[r]);const k={keys:["subject"],threshold:.3},v=new B(y,k),N=s=>{f(s.target.value)};function x(s){o.includes(s)?l(o.filter(t=>t!==s)):l([...o,s])}const w=()=>{var s=[];r.pages.map(t=>t.data.map(C=>{s=s.concat(C.id)})),l(s)},M=()=>{l([])},S=()=>{try{D.promise(async()=>await Promise.resolve(p(o)),{pending:"Removing...",success:{render(){return l([]),"Messages are deleted successfully."}},error:{render({data:s}){return s.response&&s.response.status===400?"Message not found":"Unfortunately, there is a problem in the process of deleting the message."}}})}catch(s){console.log(s)}};return e.jsxs("div",{className:"bg-gray-950 min-h-screeh",children:[e.jsx(F,{user:a.user}),e.jsx(P,{position:"top-center"}),h?e.jsx(e.Fragment,{children:e.jsxs("div",{role:"status",className:"p-4 mt-10 space-y-4 border border-gray-200 rounded shadow animate-pulse dark:divide-gray-700 md:p-6 dark:border-gray-700",children:[[...Array(6)].map((s,t)=>e.jsx("div",{children:e.jsx(R,{})},t)),e.jsx("span",{className:"sr-only",children:"Loading..."})]})}):e.jsx("div",{className:"container-fluid flex pt-8",children:e.jsxs("div",{className:"join join-vertical w-full mx-5",children:[!d.isEmpty(r)&&e.jsxs("div",{className:"flex justify-between mx-10",children:[e.jsxs("div",{className:"flex",children:[e.jsx("label",{htmlFor:"table-search",className:"sr-only",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})})}),e.jsx("input",{type:"text",id:"table-search",className:"block p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Search for message based on subject",onChange:N,disabled:b})]}),e.jsx("div",{className:"items-center",children:e.jsx("button",{type:"button",className:"text-gray-200 bg-gradient-to-r from-red-400 via-red-500 to-red-600 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center ml-2",onClick:w,children:"Select All"})})]}),!d.isEmpty(o)&&e.jsxs("div",{children:[e.jsx("button",{type:"button",className:"text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2 text-center mr-2 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800",onClick:M,children:"Cancle"}),e.jsx("button",{type:"button",class:"text-red-700 hover:text-gray-200 border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-4 py-2 text-center mr-2 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900",onClick:S,children:"Delete"})]})]}),!d.isEmpty(r)&&e.jsx(L,{dataLength:r.pages.length,next:()=>i(),hasMore:c,loader:m&&e.jsx("p",{children:"Loading..."}),className:"flex-row",children:e.jsx("div",{className:"h-full mx-auto max-w-2xl px-4 py-16 sm:px-6 sm:py-5 lg:max-w-7xl lg:px-8",children:d.isEmpty(u)?r.pages.map(s=>s.data.map(t=>e.jsx(g,{message:t,onSelect:x,selected:o.includes(t.id)}))):v.search(u).map(s=>e.jsx(g,{message:s.item,onSelect:x,selected:o.includes(s.item.id)}))})})]})})]})};export{z as default};
